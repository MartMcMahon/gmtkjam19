<!DOCTYPE html>
<html>
<meta charset=utf-8>
<title>Only One</title>
<style>
	html, body {
		margin: 0;
		border: 0;
		font-size: 16px;
	}
	.wrapper {
		width: 940px;
		padding: 10px;
		margin: 0 auto;
	}
	.gameboard {
		float: left;
		height:  480px;
		width: 480px;
	}
	.row {
		height: 10%;
		width: 100%;
		clear: both;
	}
	.boardcell {
		display: block;
		position: relative;
		float: left;
		background: green;
		height: 100%;
		width: 10%;
	}
	.boardentity {
		display: block;
		position: absolute;
		top: 10%; right: 10%; bottom: 10%; left: 10%;
		border-radius: 100%;
	}
	.controls {
		float: left;
		width: 440px;
		margin-left: 20px;
	}
</style>
<script>
	var board_size = [10, 10];
</script>
<body>
<div class="wrapper">
	<div class="gameboard">
		<script>
			for (var y=0; y<board_size[1];y++) {
				document.write("<div class='row'>");
				for (var x=0; x<board_size[0];x++) {
					document.write("<div class='boardcell' id='tile-" + x + "-" + y + "'><div class='boardentity' id='entity-" + x + "-" + y + "'></div></div>")
				}
				document.write("</div>");
			}
		</script>
	</div>
	<div class="controls">
		<div>Things Left</div>
		<h1>10</h1>
		<button>Decimate</button>
		<button>Plague (category decimate)</button>
		<button>Abiogenesis</button>
	</div>
</div>


<script type="text/javascript">
	// constants ////////////////////////////////////////////////////////////
	var board;
	var grass = { color: "greenyellow" };
	var water = { color: "blue" };
	var desert = {color: "yellow"};
	var forest = {color: "green"};
	
	var snake = {color: "red"};
	var mushroom = {color: "black"};
	var tree = {color: "brown"};
	
	var tiles = [
		grass, water, desert, forest
	]
	var teams = [
		snake, mushroom, tree
	]
	
	
	// actions ////////////////////////////////////////////////////////////
	function get_entity_count() {
		var n = 0;
		for (var y=0; y<board_size[1];y++) {
			for (var x=0; x<board_size[0];x++) {
				if (board.teams[y][x]) {
					n += 1;
				}
			}
		}
		return n;
	}
	function kill_x_random_things(n) {
		
	}
	function decimate() {
		for (var y=0; y<board_size[1];y++) {
			for (var x=0; x<board_size[0];x++) {
			
			}
		}
	}

	// utilities ////////////////////////////////////////////////////////////
	function randint(min, max) {
		return Math.floor(min + (Math.random() * (max-min)))
	}
	function choose(list) {
		return list[randint(0, list.length)];
	}
	
	
	function init_board() {
		board = {
			tiles: [],
			teams: []
		}
		for (var y=0; y<board_size[1];y++) {
			var row = [];
			for (var x=0; x<board_size[0];x++) {
				row.push(choose(tiles))
			}
			board.tiles.push(row);
		}
		for (var y=0; y<board_size[1];y++) {
			var row = [];
			for (var x=0; x<board_size[0];x++) {
				if (Math.random() > 0.7) {
					row.push(choose(teams))
				}
				else {
					row.push(null);
				}
				
			}
			board.teams.push(row);
		}
	}
	
	function render_cell(x, y, tile, team) {
		var tile_elem = document.getElementById('tile-' + x + '-' + y);
		var team_elem = document.getElementById('entity-' + x + '-' + y);
		
		tile_elem.style.background = tile.color;
		team_elem.style.background = team ? team.color : 'transparent';
	}
	function render_board() {
		for (var y=0; y<board_size[1];y++) {
			for (var x=0; x<board_size[0];x++) {
				render_cell(x, y, 
					board.tiles[y][x], 
					board.teams[y][x]
				);
			}
		}
	}
	
	
	// Start the game
	init_board()
	render_board()
</script>